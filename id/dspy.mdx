---
title: "DSPy"
description: "> Menggunakan DSPy dengan Neosantara."
---

DSPy adalah framework untuk memprogram model bahasa alih-alih mengkamulkan prompt statis. Ini memungkinkan Kamu membangun sistem AI modular dengan kode alih-alih prompt buatan tangan, dan menawarkan metode untuk mengoptimalkan sistem ini secara otomatis.

Fitur

* Pendekatan programatik untuk interaksi LLM melalui Python
* Komponen modular untuk membangun pipa AI yang kompleks
* Algoritma perbaikan mandiri yang mengoptimalkan prompt dan bobot
* Dukungan untuk berbagai aplikasi mulai dari pengklasifikasi sederhana hingga sistem RAG dan loop agen

## Menginstal Perpustakaan

```shell
pip install -U dspy -q
```

Atur kunci API Neosantara Kamu:

```shell
export NAI_API_KEY=***
```

## Contoh

Siapkan dan hubungkan DSPy ke LLM di Neosantara

```python icon="python"
import os
import dspy

# Konfigurasikan dspy dengan LLM dari Neosantara
lm = dspy.LM('openai/nusantara-base',
             api_key=os.environ.get("NAI_API_KEY"),
             api_base="https://api.neosantara.xyz/v1")

# Sekarang Kamu dapat memanggil LLM secara langsung sebagai berikut
lm("Say this is a test!", temperature=0.7)  # => ['Ini adalah sebuah tes.']
lm(messages=[{"role": "user", "content": "Say this is a test!"}])  # => ['Ini adalah sebuah tes.']
```

Sekarang kita dapat menyiapkan modul DSPy, seperti `dspy.ReAct` dengan signature khusus tugas. Misalnya, `question -> answer: str` memberi tahu modul untuk menerima pertanyaan dan menghasilkan jawaban string di bawah ini.

```python icon="python"
# Konfigurasikan dspy untuk menggunakan LLM
import os
import dspy

# Konfigurasikan dspy dengan LLM dari Neosantara
lm = dspy.LM('openai/archipelago-70b',
             api_key=os.environ.get("NAI_API_KEY"),
             api_base="https://api.neosantara.xyz/v1")

# Konfigurasikan dspy untuk menggunakan LLM
dspy.configure(lm=lm)

## Memberi agen akses ke alat pencarian wikipedia
def search_wikipedia(query: str):
    # Gunakan pencarian yang lebih umum atau halaman spesifik jika diketahui dapat dikamulkan
    # Untuk kasus khusus ini, kita tetap menggunakan URL yang disediakan tetapi menyederhanakan outputnya
    results = dspy.ColBERTv2(url='https://id.m.wikipedia.org/wiki/Prabowo_Subianto')(query, k=5) # Ambil 5 hasil
    # Kembalikan konten teks mentah untuk diproses oleh LLM
    return results[0]['text'] if results else "Informasi relevan tidak ditemukan."


## siapkan modul ReAct dengan signature pertanyaan dan jawaban string
# Mengubah signature untuk mengharapkan jawaban string
react = dspy.ReAct("question -> answer: str", tools=[search_wikipedia])

# Gunakan pertanyaan yang membutuhkan jawaban teks
pred = react(question="kapan hari ulang tahun prabowo?")

print(pred.answer)
```

<Accordion title="Lihat output">
  Output akan mengembalikan string untuk jawaban di bawah ini:

   ```bash icon="terminal"
Prabowo Subianto lahir pada tanggal 17 Oktober 1951.
```

</Accordion>