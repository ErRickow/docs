---
title: "Pesan"
description: "Buat pesan menggunakan format API Messages Anthropic melalui Neosantara."
---

Buat pesan menggunakan format API Messages Anthropic. Endpoint ini sepenuhnya kompatibel dengan SDK dan alat resmi Anthropic.

**Endpoint**

`POST /v1/messages`

### Pesan dasar

Buat pesan non-streaming.

<CodeGroup>

```typescript generate.ts
import Anthropic from '@anthropic-ai/sdk';
 
const anthropic = new Anthropic({
  apiKey: process.env.NAI_API_KEY,
  baseURL: 'https://api.neosantara.xyz/anthropic',
});
 
const message = await anthropic.messages.create({
  model: 'claude-4.5-sonnet',
  max_tokens: 150,
  messages: [
    {
      role: 'user',
      content: 'Tulis satu kalimat cerita sebelum tidur tentang unicorn.',
    },
  ],
  temperature: 0.7,
});
 
console.log('Respons:', message.content[0].text);
console.log('Penggunaan:', message.usage);
```

```python generate.py
import os
import anthropic
 
client = anthropic.Anthropic(
    api_key=os.getenv('NAI_API_KEY'),
    base_url='https://api.neosantara.xyz/anthropic'
)
 
message = client.messages.create(
    model='claude-4.5-sonnet',
    max_tokens=150,
    messages=[
        {
            'role': 'user',
            'content': 'Tulis satu kalimat cerita sebelum tidur tentang unicorn.'
        }
    ],
    temperature: 0.7,
)
 
print('Respons:', message.content[0].text)
print('Penggunaan:', message.usage)
```

</CodeGroup>

#### Format respons

```json
{
  "id": "msg_123",
  "type": "message",
  "role": "assistant",
  "content": [
    {
      "type": "text",
      "text": "Dahulu kala, seekor unicorn lembut dengan surai perak berkilauan menari melintasi awan yang diterangi cahaya bulan, menaburkan mimpi debu bintang kepada anak-anak yang tertidur di bawah."
    }
  ],
  "model": "claude-4.5-sonnet",
  "stop_reason": "end_turn",
  "usage": {
    "input_tokens": 15,
    "output_tokens": 28
  }
}
```

---

### Pesan streaming

Buat pesan streaming yang mengirimkan token saat sedang dihasilkan.

<CodeGroup>

```typescript stream.ts
import Anthropic from '@anthropic-ai/sdk';
 
const anthropic = new Anthropic({
  apiKey: process.env.NAI_API_KEY,
  baseURL: 'https://api.neosantara.xyz/anthropic',
});
 
const stream = await anthropic.messages.create({
  model: 'claude-4.5-sonnet',
  max_tokens: 150,
  messages: [
    {
      role: 'user',
      content: 'Tulis satu kalimat cerita sebelum tidur tentang unicorn.',
    },
  ],
  temperature: 0.7,
  stream: true,
});
 
for await (const event of stream) {
  if (event.type === 'content_block_delta') {
    if (event.delta.type === 'text_delta') {
      process.stdout.write(event.delta.text);
    }
  }
}
```

```python stream.py
import os
import anthropic
 
client = anthropic.Anthropic(
    api_key=os.getenv('NAI_API_KEY'),
    base_url='https://api.neosantara.xyz/anthropic'
)
 
with client.messages.stream(
    model='claude-4.5-sonnet',
    max_tokens=150,
    messages=[
        {
            'role': 'user',
            'content': 'Tulis satu kalimat cerita sebelum tidur tentang unicorn.'
        }
    ],
    temperature: 0.7,
) as stream:
    for text in stream.text_stream:
        print(text, end='', flush=True)
```

</CodeGroup>

#### Tipe event streaming

Respons streaming menggunakan [Server-Sent Events (SSE)](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events). Tipe event kuncinya adalah:

*   `message_start` - Metadata pesan awal
*   `content_block_start` - Awal dari blok konten (teks, penggunaan tool, dll.)
*   `content_block_delta` - Pembaruan konten tambahan
*   `content_block_stop` - Akhir dari blok konten
*   `message_delta` - Metadata pesan akhir (alasan berhenti, penggunaan)
*   `message_stop` - Akhir dari pesan