---
title: 'Rate Limits'
description: '> Learn about Neosantara Rate Limiting'
---

Neosantara AI employs a **Hybrid Rate Limiting System** that combines traditional **Token Quotas** with a flexible **Pay-As-You-Go** model. This ensures fair usage while allowing uninterrupted service for users who need to scale beyond their plan's limits.

---

## How It Works

1.  **Quota-First:** You consume the free tokens included in your subscription plan (Daily and Monthly quotas).
2.  **Pay-As-You-Go Fallback:** If you exhaust your daily or monthly quota, the system automatically checks your **Credit Balance**. If you have sufficient funds, you can continue using the API on a per-request paid basis.
3.  **Automatic Mode Switch:** If you exceed your **Monthly Token Limit**, your account is automatically switched to **Pay-As-You-Go Mode** permanently to prevent service interruption. We grant a one-time bonus of **Rp 10,000** upon this switch to get you started.

---

## Rate Limit Dimensions

We enforce limits across five key dimensions:

*   **`Requests per minute (RPM)`**: Short-term burst limit.
*   **`Tokens per minute (TPM)`**: Short-term congestion control.
*   **`Requests per day (RPD)`**: General fair usage guideline.
*   **`Tokens per day (TPD)`**: Daily quota. Exceeding this triggers Pay-As-You-Go for the rest of the day.
*   **`Monthly Token Limit`**: Hard cap for the plan. Exceeding this triggers the **Automatic Mode Switch**.

### API Key Limits (Standard)

Limits for standard API Key usage (Server-side/App integrations):

| Tier | RPM | TPM | Daily Tokens (TPD) | Monthly Token Limit |
| :--- | :-- | :-- | :----------------- | :------------------ |
| Free | 3 | 5,000 | 3,000 | 10,000 |
| Basic | 50 | 20,000 | 10,000 | 66,667 |
| Standard | 1,000 | 100,000 | 40,000 | 400,000 |
| Pro | 2,000 | 200,000 | 100,000 | 1,000,000 |
| Enterprise | 4,000 | 500,000 | Custom | Custom |

### CLI Limits (Device Flow)

Dedicated limits for users authenticating via the Neosantara CLI:

| Tier | Daily Tokens (TPD) | Monthly Token Limit |
| :--- | :----------------- | :------------------ |
| Free | 10,000 | 30,000 |
| Basic | 15,000 | 100,000 |
| Standard | 30,000 | 300,000 |
| Pro | 100,000 | 1,000,000 |
| Enterprise | Unlimited | Unlimited |

---

## Pay-As-You-Go Mode

When operating in **Pay-As-You-Go** mode (either because you exceeded a quota or were permanently switched):

1.  **Cost Estimation:** For each request, the system estimates the cost based on the model price and input/output tokens.
2.  **Reservation:** The estimated amount is temporarily reserved from your balance.
3.  **Settlement:** After the request completes, the actual cost is deducted (or refunded if the request failed).

If your balance is insufficient (less than the estimated cost or the minimum required buffer), you will receive a `402 Payment Required` error.

---

## Response Headers

We provide standard HTTP headers to help you track your usage:

*   `X-RateLimit-Limit`: Your total monthly token limit.
*   `X-RateLimit-Remaining`: Your remaining tokens for the month.
*   `X-RateLimit-Reset`: Timestamp (in seconds) when your monthly limit resets.

Additionally, detailed usage metadata is included in the JSON response:

```json
{
  "_metadata": {
    "usage": {
      "daily": {
        "current": 3500,
        "limit": 3000,
        "remaining": 0 // 0 indicates usage of Pay-As-You-Go or Limit Exceeded
      },
      "monthly": {
        "current": 10500,
        "limit": 10000,
        "remaining": 0
      }
    },
    "tier": {
      "name": "Free",
      "upstash_enabled": true
    }
  }
}
```

## Error Codes

### 429 Too Many Requests
Occurs when you hit a strict limit like RPM/TPM, or if you hit a Quota limit **AND** have no Balance to fall back on.

```json
{
  "error": {
    "message": "Daily token limit for your account has been exceeded.",
    "type": "usage_limit_exceeded",
    "code": "daily_quota_exceeded"
  }
}
```

### 402 Payment Required
Occurs when you are in **Pay-As-You-Go** mode but do not have enough funds to cover the request.

```json
{
  "error": {
    "message": "Insufficient balance. Your request is estimated to cost ~Rp 150 but you only have Rp 50.",
    "type": "insufficient_balance",
    "code": "payment_required"
  }
}
```