---
title: 'Anthropic Compatibility'
description: 'Use Anthropic SDK and API format with Neosantara AI models.'
---

Neosantara AI provides full compatibility with the Anthropic Messages API, allowing you to use the official Anthropic SDKs and tools with our models. This makes it easy to integrate Neosantara's capabilities into your existing Anthropic-based workflows.

<Note>
  **Endpoint Base URL**: `https://api.neosantara.xyz/anthropic`<br/>
  **Authentication**: Use `ANTHROPIC_API_KEY` environment variable or `Authorization: Bearer <token>` header
</Note>

<Warning>
  Ensure you use the `/anthropic` base URL for this SDK. Using the `/v1` base URL will result in authentication or schema errors.
</Warning>

## Quick Start

Get started with Neosantara AI using the Anthropic Messages API format.

<Steps>
  <Step title="Install Anthropic SDK">
```bash
pip install anthropic
```

```bash
npm install @anthropic-ai/sdk
```
  </Step>

  <Step title="Configure Client">

```python
import anthropic

client = anthropic.Anthropic(
    base_url="https://api.neosantara.xyz/anthropic",
    api_key="<YOUR_API_KEY>"
)
```

```javascript
import { Anthropic } from '@anthropic-ai/sdk';

const client = new Anthropic({
  baseURL: 'https://api.neosantara.xyz/anthropic',
  apiKey: '<YOUR_API_KEY>',
});
```
  </Step>

  <Step title="Make Your First Request">
```python
message = client.messages.create(
    model="nusantara-base",
    max_tokens=1000,
    messages=[
        {
            "role": "user",
            "content": "Hello! Tell me about Neosantara AI."
        }
    ]
)
print(message.content[0].text)
```

```javascript
const message = await client.messages.create({
  model: 'nusantara-base',
  max_tokens: 1000,
  messages: [
    {
      role: 'user',
      content: 'Hello! Tell me about Neosantara AI.',
    },
  ],
});

console.log(message.content[0].text);
```
  </Step>
</Steps>

## API Reference

### Required Parameters

| Parameter | Type | Description |
| ----------- | ------- | ------------- |
| `model` | string | Neosantara model ID (e.g., `nusantara-base`, `garda-beta-mini`) |
| `messages` | array | Array of message objects in conversation |
| `max_tokens` | integer | Maximum number of tokens to generate (min: 1) |

### Optional Parameters

| Parameter | Type | Default | Range | Description |
| ----------- | ------- | --------- | ------------- |
| `temperature` | number | 1.0 | 0.0-1.0 | Controls randomness in output |
| `top_p` | number | 1.0 | 0.0-1.0 | Nucleus sampling parameter |
| `top_k` | number | - | > 0 | Limits token choices to top-k options |
| `stop_sequences` | array | [] | - | Up to 5 sequences where generation stops |
| `stream` | boolean | false | - | Enable streaming responses |
| `system` | string/array | - | - | System prompt for the conversation |
| `tools` | array | [] | - | Tool definitions for function calling |
| `tool_choice` | string/object | "auto" | - | Tool selection strategy |
| `metadata` | object | {} | - | Custom metadata for tracking |
| `service_tier` | string | "auto" | - | Service tier selection |
| `thinking` | object | - | - | Extended thinking mode settings |

<Warning>
  The `thinking` parameter enables extended reasoning mode. This may increase response time but improves complex problem-solving capabilities.
</Warning>

## Streaming

Enable real-time streaming for conversational applications.

```python
import anthropic

client = anthropic.Anthropic(
    base_url="https://api.neosantara.xyz/anthropic",
    api_key="<YOUR_API_KEY>"
)

stream = client.messages.create(
    model="nusantara-base",
    max_tokens=1000,
    messages=[{"role": "user", "content": "Write a short story"}],
    stream=True
)

for chunk in stream:
    if chunk.type == 'content_block_delta':
        print(chunk.delta.text, end='', flush=True)
```

```javascript
import { Anthropic } from '@anthropic-ai/sdk';

const client = new Anthropic({
  baseURL: 'https://api.neosantara.xyz/anthropic',
  apiKey: '<YOUR_API_KEY>',
});

const stream = await client.messages.create({
  model: 'nusantara-base',
  max_tokens: 1000,
  messages: [{ role: 'user', content: 'Write a short story' }],
  stream: true,
});

for await (const chunk of stream) {
  if (chunk.type === 'content_block_delta') {
    process.stdout.write(chunk.delta.text);
  }
}
```

```bash
curl https://api.neosantara.xyz/anthropic/v1/messages \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <YOUR_API_KEY>" \
  -d '{
    "model": "nusantara-base",
    "max_tokens": 1000,
    "messages": [{"role": "user", "content": "Write a short story"}],
    "stream": true
  }'
```

## Tool Calling

Use function calling with the Anthropic Messages API format.

### Define Tools

```python
tools = [{
    "name": "get_weather",
    "description": "Get current weather for a location",
    "input_schema": {
        "type": "object",
        "properties": {
            "location": {
                "type": "string",
                "description": "City name"
            },
            "units": {
                "type": "string",
                "enum": ["celsius", "fahrenheit"],
                "description": "Temperature units"
            }
        },
        "required": ["location"]
    }
}]

message = client.messages.create(
    model="nusantara-base",
    max_tokens=1000,
    messages=[{"role": "user", "content": "What's weather in Jakarta?"}],
    tools=tools
)

# Handle tool use
for content in message.content:
    if content.type == "tool_use":
        print(f"Tool: {content.name}")
        print(f"Input: {content.input}")
```

```javascript
const tools = [{
  name: 'get_weather',
  description: 'Get current weather for a location',
  input_schema: {
    type: 'object',
    properties: {
      location: {
        type: 'string',
        description: 'City name'
      },
      units: {
        type: 'string',
        enum: ['celsius', 'fahrenheit'],
        description: 'Temperature units'
      }
    },
    required: ['location']
  }
}];

const message = await client.messages.create({
  model: 'nusantara-base',
  max_tokens: 1000,
  messages: [{ role: 'user', content: "What's weather in Jakarta?" }],
  tools: tools,
});

// Handle tool use
message.content.forEach(content => {
  if (content.type === 'tool_use') {
    console.log(`Tool: ${content.name}`);
    console.log(`Input: ${JSON.stringify(content.input)}`);
  }
});
```

### Tool Choice Control

Control how and when tools are used.

```python
# Auto mode (default)
client.messages.create(
    model="nusantara-base",
    messages=[...],
    tools=tools,
    tool_choice="auto"  # Model decides when to use tools
)

# Force specific tool
client.messages.create(
    model="nusantara-base",
    messages=[...],
    tools=tools,
    tool_choice={"type": "tool", "name": "get_weather"}
)

# Any tool mode
client.messages.create(
    model="nusantara-base",
    messages=[...],
    tools=tools,
    tool_choice="any"  # Must use at least one tool
)
```

## Response Format

### Standard Response Structure

```json
{
  "id": "msg_01A345678901BCDEF23456789",
  "type": "message",
  "role": "assistant",
  "content": [
    {
      "type": "text",
      "text": "Neosantara AI is a cutting-edge AI platform..."
    }
  ],
  "model": "nusantara-base",
  "stop_reason": "end_turn",
  "usage": {
    "input_tokens": 15,
    "output_tokens": 32
  }
}
```

### Tool Use Response Structure

```json
{
  "id": "msg_01A345678901BCDEF23456789",
  "type": "message", 
  "role": "assistant",
  "content": [
    {
      "type": "tool_use",
      "id": "toolu_01A345678901BCDEF23456789",
      "name": "get_weather",
      "input": {"location": "Jakarta", "units": "celsius"}
    },
    {
      "type": "text",
      "text": "I'll check current weather in Jakarta for you."
    }
  ],
  "model": "nusantara-base",
  "stop_reason": "tool_use",
  "usage": {
    "input_tokens": 45,
    "output_tokens": 28
  }
}
```

## Vision & Multimodal

Process images alongside text using the Messages API.

```python
import anthropic
import base64

client = anthropic.Anthropic(
    base_url="https://api.neosantara.xyz/anthropic",
    api_key="<YOUR_API_KEY>"
)

# Read image file
with open("image.jpg", "rb") as f:
    image_data = base64.b64encode(f.read()).decode("utf-8")

message = client.messages.create(
    model="nusantara-base",
    max_tokens=1024,
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "image",
                    "source": {
                        "type": "base64",
                        "media_type": "image/jpeg",
                        "data": image_data
                    }
                },
                {
                    "type": "text",
                    "text": "Describe what you see in this image."
                }
            ]
        }
    ]
)

print(message.content[0].text)
```

<Info>
  Supported image formats: JPEG, PNG, GIF, WebP<br/>
  Maximum image size: 5MB<br/>
  Supported vision models: `nusantara-base`, `archipelago-70b`, `kimi-k2`
</Info>

## Error Handling

### Common Error Codes

| HTTP Status | Error Code | Description |
| ------------- | ------------- | ------------- |
| 400 | `invalid_request_error` | Invalid parameters or malformed request |
| 401 | `authentication_error` | Invalid or missing API key |
| 429 | `rate_limit_error` | Rate limit exceeded |
| 500 | `api_error` | Internal server error |
| 503 | `overloaded_error` | Service temporarily unavailable |

### Error Response Example

```json
{
  "type": "error",
  "error": {
    "type": "invalid_request_error",
    "message": "messages: this field is required",
    "param": "messages"
  }
}
```python

### Retry Logic

```python
import anthropic
import time
from tenacity import retry, stop_after_attempt, wait_exponential

client = anthropic.Anthropic(
    base_url="https://api.neosantara.xyz/anthropic",
    api_key="<YOUR_API_KEY>"
)

@retry(
    stop=stop_after_attempt(3),
    wait=wait_exponential(multiplier=1, min=4, max=10)
)
def create_message_with_retry(**kwargs):
    return client.messages.create(**kwargs)

try:
    response = create_message_with_retry(
        model="nusantara-base",
        max_tokens=1000,
        messages=[{"role": "user", "content": "Hello!"}]
    )
    print(response.content[0].text)
except Exception as e:
    print(f"Failed after retries: {e}")
```

## Migration from OpenAI

Converting from OpenAI format to Anthropic Messages API.

### Key Differences

| Feature | OpenAI Format | Anthropic Format |
| --------- | ---------------- | ------------------- |
| Messages | `{"role": "...", "content": "..."}` | `{"role": "...", "content": [...]}` |
| System Prompt | `{"role": "system", "content": "..."}` | Separate `system` parameter |
| Streaming | `stream: true` | `stream: true` |
| Tool Calling | Function object format | Tool schema format |

### Migration Example

```python
# OpenAI style (old)
completion = client.chat.completions.create(
    model="nusantara-base",
    messages=[
        {"role": "system", "content": "You are helpful."},
        {"role": "user", "content": "Hello!"}
    ]
)

# Anthropic style (new)
message = client.messages.create(
    model="nusantara-base",
    system="You are helpful.",
    messages=[
        {"role": "user", "content": "Hello!"}
    ]
)
```

## Advanced Features

### Extended Thinking Mode

Enable deeper reasoning for complex problems.

```python
response = client.messages.create(
    model="nusantara-base",
    max_tokens=4000,
    messages=[{"role": "user", "content": "Solve this complex math problem..."}],
    thinking={
        "type": "enabled",
        "budget_tokens": 2000
    }
)
```

### Service Tiers

Control performance and cost characteristics.

```python
# Standard tier - balanced performance
response = client.messages.create(
    model="nusantara-base",
    service_tier="standard_only",
    # ... other parameters
)

# Auto tier - optimal performance selection
response = client.messages.create(
    model="nusantara-base", 
    service_tier="auto",
    # ... other parameters
)
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Models Overview" icon="layer-group" href="/en/models-overview">
    Explore all available Neosantara AI models.
  </Card>
  
  <Card title="OpenAI Compatibility" icon="code" href="/en/sdk/openai-compatible">
    Learn about our OpenAI-compatible API option.
  </Card>
  
  <Card title="Rate Limits" icon="gauge-high" href="/en/about/rate-limits">
    Understand rate limiting for your tier.
  </Card>
  
  <Card title="Error Codes" icon="exclamation-triangle" href="/en/about/errors">
    Complete reference of error codes and solutions.
  </Card>
</CardGroup>
